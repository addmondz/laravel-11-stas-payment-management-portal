import{l as n,D as I,p as G,o as a,g as o,a as u,w as P,e as D,b as l,F as S,m as q,j as B,t as h,q as L,c as N,A as j,h as U,y as J,r as Q,n as E}from"./app-B3ou0PxL.js";import{L as H,N as M}from"./sweetalert2.esm.all-DUr8Sk9c.js";import{_ as W}from"./Modal-UcU6Qfdc.js";import{P as R}from"./PrimaryButton-DGn-_LDZ.js";import{_ as K}from"./InputError-CbbjNe59.js";import{_ as T,a as z}from"./TextInput-oARU2lbz.js";const X={class:"p-6"},Y={key:0},Z={key:1},ee={class:"grid grid-cols-1 gap-4 mt-4"},te=["onUpdate:modelValue","id"],ae={value:"",disabled:"",selected:""},se=["value"],le={key:0},oe={class:"flex"},ne=["value"],de=["disabled"],re={class:"mt-6 flex justify-between"},ie={key:0,class:"text-right"},ue={__name:"SortAndFilterComponent",props:{sortAndFilters:{type:Array,default:[]},allowSorting:{type:Boolean,default:!0}},setup(v,{emit:k}){const p=n(!1),w=n(!1),i=n([]),d=n(""),c=n(""),r=n(null),f=k,x=v,y=async s=>{try{const{data:t}=await axios.get(s);return t}catch(t){r.value=t}},C=()=>{p.value=!0},b=()=>{p.value=!1},F=()=>{let s=i.value;s.sort_by=d.value,s.sort_order=c.value,f("filtersUpdated",s),b()},m=()=>{i.value=[],d.value="",c.value="",f("filtersUpdated",{filters:i.value,sort_by:d.value,sort_order:c.value}),b()},_=s=>s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()),$=n([]),A=n([]);return I(d,(s,t)=>{s!==t&&(c.value="asc"),s==""&&(c.value="")}),G(async()=>{for(const s of x.sortAndFilters)if($.value[s.name]="",A.value[s.name]="",s.field_type==="select"&&s.api){const t=await y(s.api);s.options=t}}),(s,t)=>(a(),o("section",null,[u(R,{onClick:C},{default:P(()=>t[2]||(t[2]=[D("Sort And Filters")])),_:1}),u(W,{show:p.value,onClose:b},{default:P(()=>[l("div",X,[w.value?(a(),o("div",Y,[u(H,{class:"mt-32 mb-32"})])):(a(),o("div",Z,[t[5]||(t[5]=l("h2",{class:"text-lg font-medium text-gray-900"},"Sort And Filters",-1)),l("div",ee,[(a(!0),o(S,null,q(v.sortAndFilters,(e,V)=>(a(),o("div",{key:V},[u(T,{for:e.field_name,value:e.display_name??_(e.field_name)},null,8,["for","value"]),e.field_type==="select"?B((a(),o("select",{key:0,"onUpdate:modelValue":g=>i.value[e.field_name]=g,id:e.field_name,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",required:""},[l("option",ae,"Select "+h(e.field_name),1),(a(!0),o(S,null,q(e.options,(g,O)=>(a(),o("option",{key:O,value:O},h(g),9,se))),128))],8,te)),[[L,i.value[e.field_name]]]):e.field_type==="number"?(a(),N(z,{key:1,modelValue:i.value[e.field_name],"onUpdate:modelValue":g=>i.value[e.field_name]=g,id:e.field_name,type:"number",placeholder:"Enter value",class:"mt-1 block w-full",required:"",onKeydown:j(F,["enter"])},null,8,["modelValue","onUpdate:modelValue","id"])):(a(),N(z,{key:2,modelValue:i.value[e.field_name],"onUpdate:modelValue":g=>i.value[e.field_name]=g,id:e.field_name,type:"text",placeholder:"Enter value",class:"mt-1 block w-full",required:"",onKeydown:j(F,["enter"])},null,8,["modelValue","onUpdate:modelValue","id"])),u(K,{message:A.value[e.field_name],class:"mt-2"},null,8,["message"])]))),128)),x.allowSorting?(a(),o("div",le,[u(T,{for:"sortOption",value:"Sort By"}),l("div",oe,[B(l("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),id:"sortOption",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",required:""},[t[3]||(t[3]=l("option",{value:"",selected:""},"-",-1)),(a(!0),o(S,null,q(v.sortAndFilters,(e,V)=>(a(),o("option",{key:V,value:e.field_name},h(e.display_name??_(e.field_name)),9,ne))),128))],512),[[L,d.value]]),B(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),id:"sortOrder",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",disabled:!d.value,required:""},t[4]||(t[4]=[l("option",{value:"",disabled:"",selected:""},"Select Sorting Order",-1),l("option",{value:"asc"},"Ascending",-1),l("option",{value:"desc"},"Descending",-1)]),8,de),[[L,c.value]])]),u(K,{message:A.value.sortOption,class:"mt-2"},null,8,["message"])])):U("",!0)])])),l("div",re,[l("button",{type:"button",onClick:m,class:"bg-white hover:bg-gray-100 text-black inline-flex items-center px-4 py-2 border rounded-md font-semibold text-xs uppercase tracking-widest"}," Reset Filters "),w.value?U("",!0):(a(),o("div",ie,[l("button",{type:"button",onClick:b,class:"bg-white hover:bg-gray-100 text-black inline-flex items-center px-4 py-2 border rounded-md font-semibold text-xs uppercase tracking-widest"}," Close "),u(R,{onClick:F,class:"ms-3"},{default:P(()=>t[6]||(t[6]=[D(" Apply Filters ")])),_:1})]))])])]),_:1},8,["show"])]))}},ce={key:0},me={key:1},ve={key:0},pe={key:0,class:"block mt-12"},_e={class:"grid md:grid-cols gap-4 mb-5"},fe={key:2},ye={class:"flex justify-between w-full pt-6"},ge={class:"flex justify-end flex-1"},be=["disabled"],he=["disabled"],ke={key:1},Ue={__name:"ListComponent",props:{apiUrl:{type:String,required:!0},createCompleteSignal:{type:Number,default:!1},hasPaddingTop:{type:Boolean,default:!0},sortAndFilters:{type:Array,required:!1}},setup(v){const k=n(!0),p=n([]),w=n([]),i=n(null);n(null),n(null);const d=n(null),c=n(9),r=n(1),f=n(0),x=v;I(()=>x.createCompleteSignal,m=>{m&&y(r.value)});const y=async(m=1)=>{k.value=!0;try{const _=new URLSearchParams({limit:c.value,page:m});Object.entries(w.value).forEach(([A,s])=>{s&&_.append(A,s)});const{data:$}=await J.get(`${x.apiUrl}?${_.toString()}`);p.value=$.data.data,d.value=$.data,f.value=$.data.last_page}catch(_){i.value=_}finally{k.value=!1}};G(()=>{y(r.value)});const C=()=>{r.value>=f.value||(r.value+=1,y(r.value))},b=()=>{r.value<=1||(r.value-=1,y(r.value))},F=m=>{w.value=m,y()};return(m,_)=>(a(),o("div",null,[k.value?(a(),o("div",ce,[u(H,{class:"mt-20 mb-20"})])):(a(),o("div",me,[d.value?(a(),o("div",ve,[v.sortAndFilters?(a(),N(ue,{key:0,class:"mt-6 mb-6",sortAndFilters:v.sortAndFilters,onFiltersUpdated:F},null,8,["sortAndFilters"])):(a(),o(S,{key:1},[v.hasPaddingTop?(a(),o("div",pe)):U("",!0)],64)),l("div",_e,[Q(m.$slots,"list-view",{data:p.value,apiResponse:d.value})]),p.value.length===0||p.value==[]?(a(),o("div",fe,[u(M)])):U("",!0),l("div",ye,[l("div",null,[l("p",null,"Showing "+h(d.value.from??0)+" to "+h(d.value.to??0)+" of "+h(d.value.total)+" entries",1)]),l("div",ge,[l("button",{class:E(["bg-white hover:bg-gray-200 text-gray py-2 px-4 rounded ml-2",[{"cursor-not-allowed":r.value==1}]]),onClick:b,disabled:r.value==1},"Previous Page",10,be),l("button",{class:E(["bg-black hover:bg-gray-700 text-white py-2 px-4 rounded ml-2",[{"cursor-not-allowed":r.value==f.value}]]),disabled:r.value==f.value,onClick:C},"Next Page",10,he)])])])):(a(),o("div",ke,[u(M)]))]))]))}};export{Ue as _};
